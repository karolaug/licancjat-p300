\documentclass[licencjacka,openright]{pracamgr}
\usepackage{latexsym}
\usepackage[MeX]{polski}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
%\usepackage{afterpage}
\usepackage{rotating}
%\usepackage{subfigure}%
\usepackage{polski}
\usepackage{natbib}
\usepackage{indentfirst}
\usepackage{graphicx}
\usepackage{url}
\usepackage{float}
\usepackage{amsmath}
\usepackage{antpolt}



\author{ Karol Auguštin }
\nralbumu{ 249476 }
\title{ Filtry przestrzenne w detekcji potencjału P300 }
\tytulang{ Spatial filters in detection of P300 evoked potential }
\kierunek{Zastosowania fizyki w biologii i medycynie}
\opiekun{dr hab. Jarosława Żygierewicza \\ Zakład Fizyki Biomedycznej \\ Instytut Fizyki Doświadczalnej \\ Uniwersytet Warszawski}
\dziedzina{13.2}
\specjalnosc{Neuroinformatyka}
\date{Warszawa, Wrzesień 2012}
\keywords{P300, filtry przestrzenne, interfejsy mózg -- komputer, CSP} 
\bibliographystyle{elsart-harv}
\begin{document}
\let\cleardoublepage\clearpage
\maketitle
\begin{abstract}
\par Streszczenie
\end{abstract}
\tableofcontents
%\addcontentsline{toc}{chapter}{Cel pracy}

\chapter{Wstęp}
\section{Diagnostyka medyczna}
Istnieje wiele udokumentowanych zastosowań detekcji potencjału P300 w~diagnostyce medycznej chorób układu nerwowego, zaburzeń psychicznych, a~także uszkodzeń mózgu w~wyniku urazów \citep{zgorzalewicz2000}. Opierają się one głównie na analizie wielu cech rejestrowanego potencjału takich jak: latencja względem bodźca, kształt, oraz miejsce występowania na powierzchni czaszki. Praktycznie we~wszystkich przypadkach opisanych w~literaturze sposób badania jest identyczny, jeśli porównywany jest od strony analizy sygnału. Pacjentowi podawany jest wielokrotnie bodziec ,,częsty'', przeplatany z bodźcem ,,rzadkim'', mającym wygenerować u pacjenta potencjał P300. Następnie przeprowadzane jest uśrednianie wystąpień bodźca ,,rzadkiego'' dla każdej z~elektrod i~analiza takiego wyniku wykonywana przez lekarza. W związku z~tym, że~najistotniejszym elementem badania diagnostycznego jest kształt oraz czas wystąpienia reakcji, jak równierz umiejscowienie jej na~powierzchni czaszki jedynymi metodami analizy sygnałów możliwymi do~zastosowania są~filtrowanie pasmowe i~uśrednianie, nstomiast niemożliwe jest użycie filtrów przestrzennych, czy innych metod mających na celu lepsze uwidocznienie potencjału.
\section{Interfejsy mózg -- komputer}
Najbardziej obiecującym zastosowaniem zautomatyzowanej analizy sygnału EEG są~obecnie interfejsy mózg-komputer (brain-computer interface -- BCI) mające na~celu umożliwienie komunikcji użytkownika z~komputerem bez użycia mięśni jedynie lub głównie poprzez analizę sygnału EEG zbieranego z czaszki użytkownika. Aby umożliwić wykorzystanie potencjału P300 w~takim zastosowaniu potrzebny jest złożony z~wielu elementów aparat matematyczno -- informatyczny, za~pomocą którego w~zautomatyzowany sposób możnaby rejestrować wystąpienie pojedynczego lub niewielkiej ilości potencjałów P300 w~sposób nie~wymagający udziału przeszkolonej osoby. Jako, że~w~takiej sytuacji istotny jest nie kształt czy opóźnienie załamka P300, a~samo jego wystąpienie w~reakcji na~określony bodziec dostępne są~wszystkie metody cyfrowej analizy sygnałów, o~ile okażą się~skuteczne.
\subsection{Dostęp do informacji}
Od lat osiemdziesiątych mamy do~czynienia z~dynamicznym rozwojem informatyzacji społeczeństwa, nie~tylko w~warstwie możliwości technicznych, ale~przede wszystkim w~rozumieniu społecznym. Przez ostatnie trzydzieści lat stopień zastosowania komputerów i~urządzeń elektronicznych przez społeczeństwo wzrósł, a~co~ważniejsze wzrost ten nadal występuje w~olbrzymim tempie. Unowocześnianie i~ułatwianie ludziom dostępu do~komputerów i~możliwości jakie ten dostęp umożliwia jest kluczowym zadanie producentów i~projektantów wszystkich firm produkujących użądzenia elektroniczne przeznaczone dla masowego odbiorcy. Sposób komunikacji użytkowników z~komputerem ewoluował na przestrzeni lat. Od klawiatury podłączonej do~terminala tekstowego w~latach osiemdziesiątych przez wprowadzenie na~rynek myszki i~interfejsu graficznego przez firmę Apple Computers Inc. w~1984 roku, aż~do~obecnie znanych i~coraz szerzej stosowanych ekranów dotykowych. Historia komunikacji człowieka z urządzeniami elektronicznymi pokazuje jak istotny dla współczesnego świata jest sposób dostępu człowieka do możliwości jakie dają współczesne komputery.

Rozwój urządzeń umożliwiających komunikację ludzi z~komputerami opiera się na~stosowaniu technologii eliminujących nienaturalnych i~zbędnych użądzeń pośredniczących w tejże komunikacji. Najpierw ograniczono rolę klawiatury, na~rzecz dużo prostrzej i~bardziej naturalnej myszki, żeby w końcu i~z~niej zrezygnowac na rzecz ekranu obsługiwanego w naturalny dla człowieka sposób -- palcami. Kolejnym krokiem w~tej ewolucji jest wyeliminowanie konieczności używania jakiegokolwiek interfejsu na rzecz bezpośredniego połączenia komputera z~mózgiem użytkownika.

Rozwój metod rejestracji i~analizy sygnału EEG daje nadzieję, że w~przyszłości będzie to możliwe i~dostępne dla zwykłego użytkownika.
\subsection{Pomoc osobom niepełnosprawnym}
Kolejnym aspektem zastosowania systemów BCI w~postaci, w~jakiej istnieją one dzisiaj jest pomoc osobom niepełnosprawnym, w~szczególności sparaliżowanym, pozbawionym możliwości kontaktu ze~światem zewnętrznym. Urządzenia BCI Appliance tworzone i~rozwijane na~wydziale Fizyki Uniwersytetu Warszawskiego już dzisiaj dają taką możliwość. Opierając się na znanych mechanizmach działania mózgu umożliwiają wprowadzanie informacji do komputera jedynie za pomocą koncentracji uwagi. Jednym z paradygmatów, na którm opiera się ten system jest właśnie rejestracja i~analiza potencjału P300.

\section{Cel pracy}
%I będzie w nim napisane że zbadasz i zaprezentujesz jak zastosowanie różnych filtrów przestrzennych wpływa na możliwość wykrywania wystąpienia P300, co przyczynia się do konstrukcji lepszych BCI opartych o P300.

Celem pracy jest zbadanie oraz zaprezentowanie jak~zastosowanie filtrów przestrzennych wpływa na~możliwość wykrywania występowania potencjału P300. Przyczynia się to do konstrukcji lepszych BCI opartych o paradygmat P300.



\chapter{Metodologia}
Potencjał P300 występujący w~sygnale EEG w~reakcji na~oczekiwany przez pacjenta bodziec ma złożoną charakterystykę, czyniąc go trudnym do automatycznej detekcji. Podstawowym problemem jest mała amplituda zjawiska na tle innych aktywności mózgu widocznych w sygnale EEG. Jedyną metodą uzyskania widocznego gołym okiem potencjału bez stosowania skomplikowanego aparatu matematycznego jest uśrednienie wielu realizacji eksperymentu. W takim przypadku aktywność mózgu nie związana z~występowaniem interesującego nas zjawiska jest modelowana jako szum nieskorelowany o~średniej zero, zatem ulega uśrednieniu do zera, a~interesująca nas, powtarzająca się dla każdej realizacji aktywność staje się widoczna. Takie podejście, poprawne w przypadku diagnostyki medycznej, niestety nie jest możliwe do~zastosowania w~systemach BCI, gdyż obniżyłoby skuteczność takiego systemu wymuszając na użytkowniku wielokrotne powtarzanie tej samej decyzji. Niski stosunek sygnału do szumu dla potencjału P300 bardzo utrudnia jego wykrycie przy użyciu jednej realizacji. Aby zminimalizować ilość niezbędnych powtórzeń występowania bodźca zaczęto stosować różnego rodzaju metody mające na celu wyeksponowanie go z szumu pozostałych aktywnosci mózgu, nie związanych z bodźcem podawanym pacjentowi.

Zadanie jest tym trudniejsze gdyż charakterystyka odpowiedzi, jak również czas jej występowania po podaniu bodźca różni się pomiędzy pacjentami. Do najprostszych metod stosowanych w pierwszej kolejności należą przede wszystkim filtrowanie dolnoprzepustowe oraz uśrednianie sygnału z~wielu realizacji eksperymentu.

Bardziej zaawansowanymi metodami jest zaprojektowanie odpowiednich filtrów przestrzennych, maących na celu poprawę stosunku sygnału do szumu kożystając z~różnicy w rozkładzie przestrzennym szumu i~interesującej nas aktywności. Przykłady takich filtrów zostaną przedstawione w~kolejnych paragrafach.


\section{Filtry przestrzenne}
Filtry przestrzenne poprawiają stosunek sygnału do szumu wykorzystując różny rozkład przestrzenny składowej będącej sygnałem i~składowej będącej szumem, czyli sygnałem nie~zawierającym składowych istotnych z punktu widzenia badanego zagadnienia.
Filltr przestrzenny może być zrealizowany w postaci macierzy $M$ takiej,~że: 
Y = M*X
gdzie: $X$ oznacza sygnał mierzony, natomiast $Y$ sygnał filtrowany.


\subsection{Filtr tożsamościowy}
Aby zaobserwować efekty uzyskane za~pomocą różnych filtrów przestrzennych przedstawię dane zarejestrowane podczas eksperymentów bez użycia żadnego z~nich. Macierz przejścia dla takich danych jest macierzą, która na diagonali ma~wartości~1~oraz~0~w~pozostałych polach.
Dla trzech kanałów taka macierz ma~postać:
\[
M =
\begin{bmatrix}
  $1$ & $0$ & $0$ \\
  $0$ & $1$ & $0$ \\
  $0$ & $0$ & $1$ 
\end{bmatrix}
\]

\subsection{Transformata Hjorta}
Transformacja Hjortha jest numerycznym przybliżeniem transformaty Laplace'a czyli drugiej pochodnej przestrzennej. Uzyskuje się ją poprzez odjęcie od każdego kanału średniej z kanałów go otaczających. Ma on na celu eliminację składowej wspólnej dla transformowanych kanałów, czyli pochodzącej od~źródeł odległych. Sygnał pozostający w~każdym kanale po zastosowaniu takiego filtra powinien odwzorowywać aktywność EEG zachodzącą bezpośrednio w~miejscu umieszczenia elektrody, eliminując czasem mocniejszą aktywność z~innych obszarów czaszki.
Macierz przejścia w~przypadku zastosowania takiego filtra jest ściśle związana z~lokalizacją elektrod na głowie pacjenta.
Przykładowa macierz przejścia ma postać przykładowo w~systemie EEG 10-20 dla elektrody $Cz$ ma~on~postać:
\begin{equation}
Cz' = Cz - 1/4(Fz+C4+Pz+C4)
\end{equation}

\subsection{Wspólny wzorzec przestrzenny}
Common Spatial Patterns (CSP) jest dyskryminacyjnym algorytmem pozyskującym przestrzenny filtr $W$ z~danych $X$, tak że różnica wariancji fitrowanego sygnału\mbox{$X_{CSP} = X \cdot W$} dla dwóch klas jest maksymalna. Osiągane jest to poprzez jednoczesną diagonalizację macierzy kowariancji:
\begin{equation}
\Sigma _2 W = (\Sigma _1 + \Sigma _2 )W \Delta
\end{equation}
gdzie $\Sigma_1$ i $\Sigma_2$ są kowariancjami macierzy sygnałów z~klas~1~oraz~2. Każda kolumna $W$ jest filtrem przestrzennym $w_i$ odpowiadającym wartości własnej $\delta _i$ w~macierzy $\Delta$, wartości $i = 1,2,3 \ldots N_c$ odpowiadają numerom kanałów sygnału oryginalnego \citep{sannelli2011}.

\section{Miara jakości}
Jakość wstępnej analizy sygnałów jest tym lepsza im~zbiór cech wydobytych z~sygnału zarejestrowanego jako target jest różny od cech sygnału non-target będącego szumem z~punktu widzenia analizowanego zagadnienia. Jako, że zjawisko analizowane, takie jak wystąpienie potencjału P300, powtarzane jest w~każdej realizacji sygnału target, natomiast pozostałe zjawiska będące szumem nie są skorelowane z~bodźcem, uśrednienie wielu powtórzeń rejestracji pożądanego zjawiska powoduje wyeliminowanie sygnału pochodzącego od innych zjawisk na rzecz sygnału pochodzącego od zjawiska oczekiwanego.

Jako, że czas wystąpienia potencjału P300 po podaniu bodźca jest powtarzalny dla danego pacjenta, proponowaną miarą jakości jest maksymalna wartość funkcji korelacji w otoczeniu zera pomiędzy średnią z~wszystkich sygnałów target uzyskanych podczas sesji kalibracyjnej oraz sygnałem poddawanym analizie.

Miarą skuteczności danej metody jest odległość Mahalanobisa, zwana ważoną odległością euklidesową, którą można zastosować do mierzenia odległości pomiędzy dwoma zbiorami punktów~w przestrzeni wielowymiarowej.

\chapter{Dane}
Dane do analizy opisanych metod były zbierane podczas sesji kalibracyjnej, w~której osoba badana patrzyła się na jeden z~ośmiu sekwencyjnie zapalających się kwadratów. Dzięki temu zebrane dane opatrzone są~informacją, czy należą do~grupy target, w~przypadku zapalenia się obserwowanego pola, czy non-target w~pozostałych przypadkach.

W obu przypadkach zastosowano próbkowanie z~częstotliwością 128Hz, gdyż zawartość częstotliwościowa potencjału P300 jest niewielka, a~nadmiarowe próbkowanie zwiększa poziom szumu oraz znacznie wydłuża czas obliczeń. Zarejestrowano dane z~20~kanałów rozmieszczonych w~systemie 10-20.

Podczas użytej do obliczeń sesji kalibracyjnej zebrano 64 realizacje sygnału target i 528 realizacji sygnału non-target.

Do wszystkich obliczeń został zastosowany wstępny montaż danych względem uśrednionych odprowadzeń usznych A1 oraz A2. 

\chapter{Wyniki}

\section{Porównanie sygnałów}

\subsection{Filtr tożsamościowy}
\subsection{Transformata Hjorta}
\subsection{Wspólny wzorzec przestrzenny}

\section{Porównanie cech}

\subsection{Filtr tożsamościowy}
\subsection{Transformata Hjorta}
\subsection{Wspólny wzorzec przestrzenny}

\section{Odległość Mahalanobisa}

\chapter{Dyskusja i Wnioski}


\bibliography{biblio}
\end{document}
